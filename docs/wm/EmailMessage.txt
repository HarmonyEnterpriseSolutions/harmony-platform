Сообщение целиком задается в xml формате
Смотрите пример: EmailMessage.xml

Ести текст сообщения в plain, он пишется в body

Если текст сообщения в html, он пишется в attachment, причем аттрибут filename должен 
отсутствовать а body должно быть пустым или отсутствовать.
Такой вариант корректно отображается в 
	Outlook Express
	The Bat 1.61
	допишите, где видели

В последствии этот xml форматируется, см. TextReportTemplate.txt.
И из отформатированного результата генерируется письмо.
